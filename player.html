<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link rel="icon" href="/assets/favicon.png" type="image/x-icon">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>M3U8 Player</title>
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://site-assets.fontawesome.com/releases/v7.1.0/css/all.css" />
    <link rel="stylesheet" href="/assets/player.css">
</head>
<body>
    <header>
        <nav class="navbar">
            <a href="/" class="logo">
                <i class="fas fa-play-circle"></i>
                M3U8 SCANNER
            </a>
            <a href="/" class="nav-link">
                <i class="fas fa-home"></i>
                Back to Home
            </a>
        </nav>
    </header>
    <div class="main-content">
        <div class="player-container">
            <div class="player-section">
                <div class="error-message" id="error"></div>
                <div class="video-wrapper">
                    <video id="video" preload="metadata" playsinline webkit-playsinline></video>
                    <div class="loading-overlay" id="loadingOverlay">
                        <div class="video_sspinner" data-layer="4">
                            <div>
                                <div class="video_sspinner-container">
                                    <div class="video_sspinner-rotator">
                                        <div class="video_sspinner-left">
                                            <div class="video_sspinner-circle"></div>
                                        </div>
                                        <div class="video_sspinner-right">
                                            <div class="video_sspinner-circle"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="stats-overlay" id="statsOverlay">
                        <div class="stats-panel">
                            <small>Video Info</small>
                            <div class="stats-row">
                                <div class="stats-item">
                                    <div class="stats-label">Video ID</div>
                                    <div class="stats-value" id="videoId">—</div>
                                </div>
                                <div class="stats-item">
                                    <div class="stats-label">Viewport / FPS</div>
                                    <div class="stats-value" id="viewportFrames">—</div>
                                </div>
                                <div class="stats-item">
                                    <div class="stats-label">Current / Optimal Res</div>
                                    <div class="stats-value" id="res">—</div>
                                </div>
                                <div class="stats-item">
                                    <div class="stats-label">Codecs</div>
                                    <div class="stats-value" id="codecs">—</div>
                                </div>
                            </div>
                            <small style="margin-top: 8px">Playback</small>
                            <div class="stats-row">
                                <div class="stats-item">
                                    <div class="stats-label">Volume / Normalized</div>
                                    <div class="stats-value" id="volumeStats">—</div>
                                </div>
                                <div class="stats-item">
                                    <div class="stats-label">Connection Speed</div>
                                    <div class="stats-value" id="connSpeed">—</div>
                                    <div class="stats-bar"><i id="connBar"></i></div>
                                </div>
                                <div class="stats-item">
                                    <div class="stats-label">Buffer Health</div>
                                    <div class="stats-value" id="bufferHealth">—</div>
                                    <div class="stats-bar"><i id="bufferBar"></i></div>
                                </div>
                            </div>
                        </div>
                        <div class="stats-panel small-right">
                            <small>Diagnostics</small>
                            <div class="stats-row" style="justify-content: flex-end;">
                                <div class="stats-item">
                                    <div class="stats-label">Network Activity</div>
                                    <div class="stats-value" id="netActivity">—</div>
                                </div>
                                <div class="stats-item">
                                    <div class="stats-label">Volume (LUFS est.)</div>
                                    <div class="stats-value" id="lufs">—</div>
                                </div>
                                <div class="stats-item">
                                    <div class="stats-label">Color</div>
                                    <div class="stats-value" id="color">—</div>
                                </div>
                                <div class="stats-item">
                                    <div class="stats-label">Date</div>
                                    <div class="stats-value" id="date">—</div>
                                </div>
                            </div>
                            <small style="margin-top: 8px">Codec / Frames stats</small>
                            <div style="margin-top: 8px">
                                <div class="stats-label">Decoded frames</div>
                                <div class="stats-value" id="framesDecoded">—</div>
                                <div class="stats-label" style="margin-top: 6px">Dropped frames</div>
                                <div class="stats-value" id="framesDropped">—</div>
                            </div>
                        </div>
                    </div>
                    <div class="seek-feedback" id="seekFeedback"></div>
                    <div class="context-menu" id="contextMenu">
                        <div class="context-item" data-action="loop">
                            <i class="fas fa-redo"></i>
                            <span>Loop</span>
                            <div class="context-check">
                                <i class="fas fa-check" style="display: none;"></i>
                            </div>
                        </div>
                        <div class="context-item" data-action="snapshot">
                            <i class="fas fa-camera"></i>
                            <span>Save video frame as</span>
                        </div>
                        <div class="context-divider"></div>
                        <div class="context-item" data-action="pip">
                            <i class="fas fa-picture-in-picture"></i>
                            <span>Picture-in-Picture</span>
                        </div>
                        <div class="context-item" data-action="stats">
                            <i class="fas fa-chart-bar"></i>
                            <span>Stats overlay</span>
                            <div class="context-check">
                                <i class="fas fa-check" style="display: none;"></i>
                            </div>
                        </div>
                        <div class="context-item" data-action="fullscreen">
                            <i class="fas fa-expand"></i>
                            <span>Fullscreen</span>
                        </div>
                        <div class="context-divider"></div>
                        <div class="context-item" data-action="reset">
                            <i class="fas fa-undo"></i>
                            <span>Reset player</span>
                        </div>
                    </div>
                    <div class="custom-controls">
                        <div class="progress-container" id="progressContainer">
                            <div class="progress-bar-wrapper">
                                <div class="progress-buffer" id="progressBuffer"></div>
                                <div class="progress-filled" id="progressFilled">
                                    <div class="progress-handle"></div>
                                </div>
                            </div>
                        </div>
                        <div class="controls-row">
                            <button class="control-btn play-pause-btn" id="playPauseBtn">
                                <i class="fas fa-play"></i>
                                <span class="tooltip">Play/Pause (space)</span>
                            </button>
                            <button class="control-btn" id="backwardBtn" title="10s zurück">
                                <i class="fas fa-backward"></i>
                                <span class="tooltip">Back 10s (←)</span>
                            </button>
                            <button class="control-btn" id="forwardBtn" title="10s vor">
                                <i class="fas fa-forward"></i>
                                <span class="tooltip">Forward 10s (→)</span>
                            </button>
                            <div class="volume-control">
                                <button class="control-btn" id="volumeBtn">
                                    <i class="fas fa-volume-up"></i>
                                    <span class="tooltip">Volume (m)</span>
                                </button>
                                <div class="volume-slider-wrapper">
                                    <input type="range" id="volumeBar" value="25" min="0" max="100">
                                </div>
                            </div>
                            <div class="time-display">
                                <span id="currentTime">00:00</span> / <span id="duration">00:00</span>
                            </div>
                            <div class="controls-spacer"></div>
                            <button class="control-btn" id="infoBtn" title="Stream Info">
                                <i class="fas fa-info-circle"></i>
                                <span class="tooltip">Stream Info (i)</span>
                            </button>
                            <div class="settings-wrapper">
                                <button class="control-btn" id="settingsBtn" title="Geschwindigkeit">
                                    <i class="fas fa-cog"></i>
                                    <span class="tooltip">Playback Speed</span>
                                </button>
                                <div class="settings-menu" id="settingsMenu">
                                    <div class="settings-menu-title">Playback Speed</div>
                                    <div class="settings-item" data-speed="0.5">
                                        <span>0.5x</span>
                                        <i class="fas fa-check" style="display: none;"></i>
                                    </div>
                                    <div class="settings-item" data-speed="0.75">
                                        <span>0.75x</span>
                                        <i class="fas fa-check" style="display: none;"></i>
                                    </div>
                                    <div class="settings-item active" data-speed="1">
                                        <span>Normal</span>
                                        <i class="fas fa-check"></i>
                                    </div>
                                    <div class="settings-item" data-speed="1.25">
                                        <span>1.25x</span>
                                        <i class="fas fa-check" style="display: none;"></i>
                                    </div>
                                    <div class="settings-item" data-speed="1.5">
                                        <span>1.5x</span>
                                        <i class="fas fa-check" style="display: none;"></i>
                                    </div>
                                    <div class="settings-item" data-speed="2">
                                        <span>2x</span>
                                        <i class="fas fa-check" style="display: none;"></i>
                                    </div>
                                </div>
                            </div>
                            <button class="control-btn" id="pipBtn" title="Picture-in-Picture">
                                <i class="fas fa-picture-in-picture"></i>
                                <span class="tooltip">Picture-in-Picture (Ctrl+P)</span>
                            </button>
                            <button class="control-btn" id="fullscreenBtn" title="Vollbild">
                                <i class="fas fa-expand"></i>
                                <span class="tooltip">Fullscreen (f)</span>
                            </button>
                        </div>
                    </div>
                </div>
                <div class="controls-section">
                    <input type="text" id="urlInput" placeholder="Enter M3U8 URL..."value="">
                    <button class="btn-load" id="streamStarter">
                        <i class="fas fa-play"></i>
                        Play
                        <span class="tooltip">Load and play stream</span>
                    </button>
                </div>
                <div class="info-box">
                    <div class="info-left">
                        <div class="status">
                            <div class="status-dot" id="statusDot"></div>
                            <span id="statusText">Ready</span>
                        </div>
                        <span id="quality"></span>
                    </div>
                    <div class="info-right">
                        <div class="toggle-container">
                            <label class="toggle-label">Standard Controls</label>
                            <label class="toggle-switch">
                                <input type="checkbox" id="defaultControlsToggle">
                                <span class="toggle-slider"></span>
                            </label>
                        </div>
                    </div>
                </div>
                <div class="info-card" style="margin-top: auto;">
                    <h3><i class="fas fa-plug"></i> Use API</h3>
                    <p style="margin-bottom: 1rem;">The base url for the API endpoint is <code>https://m3u8scanner.itsmarian.is-a.dev/api-player/</code> after this you can use these custom parameters to change the design the way you like it.</p>
                    <div>
                        <a><code>?video_m3u8_src=URL</code>: Plays the video from URL (required)</a>
                    </div>
                    <div>
                        <a><code>?volume=NMBR</code>: Sets the volume of the video to NMBR (default: 0, range: 0 - 1, does not work with autoplay on default!)</a>
                    </div>
                    <div>
                        <a><code>?autoplay=true</code>: Starts the video automatically (default: false)</a>
                    </div>
                    <div>
                        <a><code>?autoskip_to_latest=true</code>: Enables automatic skipping to the end (default: false)</a>
                    </div>
                    <div>
                        <a><code>?autoskip_interval=TIME</code>: Skips to the end every TIME seconds (default: off)</a>
                    </div>
                    <div>
                        <a>
                            <code>?muted=false</code>: Autoplay with sound (default: true)
                            <br>
                            To autoplay audio automatically, you need to set "Sound" in <code>chrome://settings/content/siteDetails?site=https%3A%2F%2Fm3u8scanner.itsmarian.is-a.dev</code> to "Allow".
                        </a>
                    </div>
                    </p>
                </div>
            </div>
        </div>
    </div>
    <script src="/assets/player.js"></script>
</body>
</html>